<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Lesson 10 homework</title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
  <!--Задача №1 "Создать скрывающееся/рвскрывающееся меню"-->
  <div id="exercise_1" class="exercise">
    <div class="conditions">
      При помощи 1 обработчика сделайте (скрытие/раскрытие) пунктов списка
      при сворачивании списка, знак "плюс" должен меняться на "минус"
    </div>
    <div class="solution">
      <div id="toggle-list" class="toggle-list">
        <ul class="toggle-list_list">
          <div class="toggle-list_toggler">
            <div class="toggle-list_toggler_icon">+</div>
            <div class="toggle-list_toggler_label">Страны</div>
          </div>
          <li class="toggle-list_item">
            <ul class="toggle-list_list">
              <div class="toggle-list_toggler">
                <div class="toggle-list_toggler_icon">+</div>
                <div class="toggle-list_toggler_label">Россия</div>
              </div>
              <li class="toggle-list_item">Москва</li>
              <li class="toggle-list_item">Питер</li>
              <li class="toggle-list_item">Омск</li>
            </ul>
          </li>
          <li class="toggle-list_item">
            <ul class="toggle-list_list">
              <div class="toggle-list_toggler">
                <div class="toggle-list_toggler_icon">+</div>
                <div class="toggle-list_toggler_label">Америка</div>
              </div>
              <li class="toggle-list_item">Нью-Йорк</li>
              <li class="toggle-list_item">Лос-Анджелес</li>
              <li class="toggle-list_item">Чикаго</li>
            </ul>
          </li>
          <li class="toggle-list_item">
            <ul class="toggle-list_list">
              <div class="toggle-list_toggler">
                <div class="toggle-list_toggler_icon">+</div>
                <div class="toggle-list_toggler_label">Китай</div>
              </div>
              <li class="toggle-list_item">Шанхай</li>
              <li class="toggle-list_item">Пекин</li>
              <li class="toggle-list_item">Тяньцзинь</li>
            </ul>
          </li>
        </ul>
      </div>
      <script>
        const exercise1 = document.querySelector('#exercise_1 #toggle-list');
        
        exercise1.addEventListener('click', closeOpen);

        function closeOpen(event) {
          let target = event.target;

          if (target.classList.contains('toggle-list_toggler_label') || target.classList.contains('toggle-list_toggler_icon')) {
            target = target.closest('.toggle-list_list');
            let arr = target.querySelectorAll('li');
            let icon = target.querySelector('.toggle-list_toggler_icon');
            (icon.textContent === '+') ? icon.textContent = '-' : icon.textContent = '+';
            Array.from(arr).forEach(function(item) {
              item.hidden = !item.hidden;
              //item.classList.toggle('close');   // или так
            });
          }
        }

      </script>
    </div>
  </div>

    <!--Задача №2 "Оживить карусель"-->
    <div id="exercise_2" class="exercise">
      <div class="conditions">
        <p>
          При клике на синюю кнопку, карусель должна прокрутиться на 1 элемент вправо (если мы не достигли конца)
        </p>
        <p>
          При клике на красную кнопку карусель должна прокрутиться на 1 элемент влево (если мы не достигли начала)
        </p>
        <p>
          <em>
            Постарайтесь написать свою разметку html, чтобы понять принцип работы карусели
          </em>
        </p>
      </div>
      <div class="solution">
        <div class="carousel">
          <div class="carousel_button carousel_button_prev"></div>
          <div class="carousel_button carousel_button_next"></div>
          <div class="carousel_list_wrapper">
            <ul class="carousel_list">
              <li class="carousel_list_item">
                <img src="https://ru.js.cx/carousel/1.png" alt="smile-1">
              </li>
              <li class="carousel_list_item">
                <img src="https://ru.js.cx/carousel/2.png" alt="smile-2">
              </li>
              <li class="carousel_list_item">
                <img src="https://ru.js.cx/carousel/3.png" alt="smile-3">
              </li>
              <li class="carousel_list_item">
                <img src="https://ru.js.cx/carousel/4.png" alt="smile-4">
              </li>
              <li class="carousel_list_item">
                <img src="https://ru.js.cx/carousel/5.png" alt="">
              </li>
              <li class="carousel_list_item">
                <img src="https://ru.js.cx/carousel/6.png" alt="">
              </li>
              <li class="carousel_list_item">
                <img src="https://ru.js.cx/carousel/7.png" alt="">
              </li>
              <li class="carousel_list_item">
                <img src="https://ru.js.cx/carousel/8.png" alt="">
              </li>
              <li class="carousel_list_item">
                <img src="https://ru.js.cx/carousel/9.png" alt="">
              </li>
              <li class="carousel_list_item">
                <img src="https://ru.js.cx/carousel/10.png" alt="">
              </li>
            </ul>
          </div>
        </div>
        <script>

          const exercise2 = document.querySelector('#exercise_2');
          let slideIndex = 3,
              slides = exercise2.querySelectorAll('.carousel_list_item'),
              prev = exercise2.querySelector('.carousel_button_prev'),
              next = exercise2.querySelector('.carousel_button_next');         

          showSlides(slideIndex);

          function showSlides(n) {

            if (n > slides.length) {
              slideIndex = 10;
              //console.log('n>slides.length  ' + n);
            }
            if (n < 3) {
              slideIndex = 3;
              //console.log('n<3  ' + n);
            }
            if (n <= slides.length) {
              //console.log('next  ' + n);
              slides.forEach((item) => item.style.display = 'none');
              slides[slideIndex - 1].style.display = 'block';
              slides[slideIndex - 2].style.display = 'block';
              slides[slideIndex - 3].style.display = 'block';
            }

          }

          function plusSlides(n) {
            showSlides(slideIndex += n); 
          }

          prev.addEventListener('click', function() {
            plusSlides(-1);
          });

          next.addEventListener('click', function() {
            plusSlides(1);
          });

        </script>
      </div>
    </div>

  <!--Задача №3 "Поведение подсказка"-->
  <div id="exercise_3" class="exercise">
    <div class="conditions">
        При наведении мыши на элемент <em>(количество таких элементов на странице может быть любым)</em> с атрибутом data-tooltip,
        над ним должна показываться подсказка и скрываться при переходе на другой элемент.
    </div>
    <div class="solution">
      <div class="article">
        <p>
            Товарищи! сложившаяся структура организации представляет собой интересный эксперимент проверки направлений прогрессивного развития. С другой стороны рамки и место обучения кадров способствует подготовки и реализации модели развития.
        </p>
        <button data-tooltip="эта подсказка длиннее, чем элемент">Короткая кнопка</button>
        <button data-tooltip="HTML<br>подсказка">Ещё кнопка</button>
      </div>
      <script>
        const exercise3 = document.querySelector('#exercise_3');
        const button = exercise3.querySelector('button');

        let hint = null;

        exercise3.addEventListener('mouseover', function(event) {
          target = event.target;

          if (target.tagName ==='BUTTON') {
            hint = document.createElement('div');
            hint.innerHTML = target.dataset.tooltip;
            hint.classList.add('hint');
            //hint.className = 'hint';
            target.before(hint);
            //document.body.append(hint);
            

            let coords = target.getBoundingClientRect();

            let left = coords.left + (target.offsetWidth - hint.offsetWidth) / 2;
            if (left < 0) left = 0; // не заезжать за левый край окна

            let top = coords.top - hint.offsetHeight - 5;

            hint.style.left = left + 'px';
            hint.style.top = top + 'px';

          }
          
        });

        exercise3.addEventListener('mouseout', function(event) {
          if (hint) {
            hint.remove();
            hint = null;
          }
        });
        
      </script>
    </div>
</div>

<!--Задача №4 Самостоятельно: "Отмена действия по умолчанию"-->
  <div id="exercise_4" class="exercise">
    <div class="conditions">
      Решить при помощи делегирования
      Можно добавить в html любые атрибуты
    </div>
    <div class="solution">
      <div class="menu_highlight">
        <ul class="menu_highlight_list">
            <li class="menu_highlight_item">
              <a href="https://yandex.ru">
                  Переход на yandex только при клике правой кнопкой мыши
              </a>
            </li>
            <li class="menu_highlight_item">
              <a id="google" href="https://google.ru">
                <strong>
                  Переход на google только при двойном клике
                </strong>
              </a>
            </li>
            <li class="menu_highlight_item">
              <a id="mail" href="https://mail.ru">
                <em>
                  Переход на mail только при клике с нажатой кнопкой 'Shift'
                </em>
              </a>
            </li>
        </ul>
      </div>
      <script>
        //onclick="event.preventDefault()" можно добавить атрибут в каждый тег <а>, в место функции clickDefault

        const exercise4 = document.querySelector('#exercise_4 .menu_highlight_list');
        const tagsA = exercise4.querySelectorAll('a');

          // менее гибкий способ
          // tagsA[0].addEventListener('click', clickDefault);
          // tagsA[0].addEventListener('contextmenu', yandex);
          // tagsA[1].addEventListener('click', clickDefault);
          // tagsA[1].addEventListener('dblclick', google);
          // tagsA[2].addEventListener('click', clickDefault);
          // tagsA[2].addEventListener('click', mail);


        Array.from(tagsA).forEach((item) => {
          switch((item.href)) {
            case"https://yandex.ru/": 
              //console.log('hello 1');
              item.addEventListener('click', clickDefault);
              item.addEventListener('contextmenu', yandex);
              break;
            case"https://google.ru/": 
              //console.log('hello 2');
              item.addEventListener('click', clickDefault);
              item.addEventListener('dblclick', google);
              break;
            case"https://mail.ru/": 
              //console.log('hello 3');
              exercise4.addEventListener('click', clickDefault);
              item.addEventListener('click', mail);
              break;
          }
        });
        
        function clickDefault(event) {
          const target = event.target;

          if (target.closest('A')) {
            event.preventDefault();
            console.log('click');
          }
        };

        function yandex(event) {
        
          event.preventDefault();
          const link = event.target.href;
          window.open(link);
        
        };

        function google(event) {

          event.preventDefault();
          const link = event.target.closest('A').href;
          window.open(link);
      
        };

        function mail(event) {

          const link = event.target.closest('A').href;
          if (event.shiftKey) {
            window.open(link);
          }

        };

      </script>
    </div>
  </div>
</body>
</html>
